var fs=require("fs");_frame.app_picviewer={btn_fullview:null,input_saveas:null,toggle_fullview:function(){$("#picviewer").toggleClass("fullview"),_frame.app_picviewer.btn_fullview.html($("#picviewer").hasClass("fullview")?"适应窗口":"原尺寸显示")},init:function(){if(_frame.app_picviewer.is_init)return!0;var e=_g.uriSearch("pic"),i=$("#picviewer-toolbar"),p=e.split("/");p=p[p.length-1],e&&$("<img/>",{src:e}).appendTo($("#picviewer").addClass("fullview")),_frame.app_picviewer.btn_fullview=$("<button/>",{type:"button",html:"适应窗口"}).on({click:function(){_frame.app_picviewer.toggle_fullview()}}).appendTo(i),_frame.app_picviewer.input_saveas=$("<input/>",{type:"file",nwsaveas:decodeURI(p)}).on({change:function(){var i=$(this),p=i.val();p&&(fs.readFile(e.substr(1),function(e,i){if(e)throw e;fs.writeFile(p,i)}),i.val(""))}}).appendTo(_frame.dom.hidden),$("<button/>",{type:"button",html:"保存图片"}).on({click:function(){_frame.app_picviewer.input_saveas.trigger("click")}}).appendTo(i),_frame.app_picviewer.is_init=!0}};